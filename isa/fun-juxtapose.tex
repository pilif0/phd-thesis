\isacomm{fun}\ juxtapose\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}\isatv{s}\ {\isacharcolon}{\isacharcolon}\ side{\isacharunderscore}in{\isacharunderscore}out{\isacharcomma}\ \isatv{a}{\isacharcomma}\ \isatv{p}{\isacharcomma}\ \isatv{l}{\isacharparenright}\ port{\isacharunderscore}graph\ {\isasymRightarrow}\ {\isacharparenleft}\isatv{s}{\isacharcomma}\ \isatv{a}{\isacharcomma}\ \isatv{p}{\isacharcomma}\ \isatv{l}{\isacharparenright}\ port{\isacharunderscore}graph\isanewline
\isaindent{\isacomm{fun}\ juxtapose\ }{\isasymRightarrow}\ {\isacharparenleft}\isatv{s}{\isacharcomma}\ \isatv{a}{\isacharcomma}\ \isatv{p}{\isacharcomma}\ \isatv{l}{\isacharparenright}\ port{\isacharunderscore}graph{\isachardoublequoteclose}\isanewline
\ \ \isaOcomm{where}\ {\isachardoublequoteopen}\isafv{juxtapose}\ \isabv{x\ y}\ {\isacharequal}\ PGraph\isanewline
\ \ \ \ {\isacharparenleft}\ pg{\isacharunderscore}nodes\ \isabv{x}\ {\isacharat}\ pg{\isacharunderscore}nodes\ \isabv{y}{\isacharparenright}\isanewline
\ \ \ \ {\isacharparenleft}\ pg{\isacharunderscore}edges\ \isabv{x}\ {\isacharat}\isanewline
\ \ \ \ \ \ map\ {\isacharparenleft}shiftOpenInEdge\ {\isacharparenleft}{\isasymlambda}\isabv{s}{\isachardot}\ length\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}\isabv{p}{\isachardot}\ port{\isachardot}side\ \isabv{p}\ {\isacharequal}\ \isabv{s}{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\   \isabv{x}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\isaindent{\ \ \ \ \ \ map\ {\isacharparenleft}shiftOpenInEdge\ }{\isacharparenleft}{\isasymlambda}\isabv{s}{\isachardot}\ length\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}\isabv{p}{\isachardot}\ port{\isachardot}side\ \isabv{p}\ {\isacharequal}\ \isabv{s}{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\   \isabv{x}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\isaindent{\ \ \ \ \ \ map\ }{\isacharparenleft}pg{\isacharunderscore}edges\ \isabv{y}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ {\isacharparenleft}\ pg{\isacharunderscore}ports\ \isabv{x}\ {\isacharat}\isanewline
\ \ \ \ \ \ map\ {\isacharparenleft}shiftPort\ {\isacharparenleft}{\isasymlambda}\isabv{s}{\isachardot}\ length\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}\isabv{p}{\isachardot}\ port{\isachardot}side\ \isabv{p}\ {\isacharequal}\ \isabv{s}{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\ \isabv{x}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\isaindent{\ \ \ \ \ \ map\ }{\isacharparenleft}pg{\isacharunderscore}ports\ \isabv{y}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}%
