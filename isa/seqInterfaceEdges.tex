\isacomm{fun}\ seqInterfaceEdges\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}\isatv{s}\ {\isacharcolon}{\isacharcolon}\ side{\isacharunderscore}in{\isacharunderscore}out{\isacharcomma}\ \isatv{a}{\isacharcomma}\ \isatv{p}{\isacharcomma}\ \isatv{l}{\isacharparenright}\ port{\isacharunderscore}graph\isanewline
\isaindent{\isacommand{fun}\ seqInterfaceEdges\ }{\isasymRightarrow}\ {\isacharparenleft}\isatv{s}{\isacharcomma}\ \isatv{a}{\isacharcomma}\ \isatv{p}{\isacharcomma}\ \isatv{l}{\isacharparenright}\ port{\isacharunderscore}graph\isanewline
\isaindent{\isacommand{fun}\ seqInterfaceEdges\ }{\isasymRightarrow}\ {\isacharparenleft}\isatv{s}{\isacharcomma}\ \isatv{a}{\isacharcomma}\ \isatv{p}{\isacharparenright}\ edge\ list{\isachardoublequoteclose}\isanewline
\ \ \isaOcomm{where}\ {\isachardoublequoteopen}\isafv{seqInterfaceEdges}\ \isabv{x\ y}\ {\isacharequal}\isanewline
\ \ remdups\isanewline
\ \ \ \ {\isacharparenleft}\ edgesFromPortMapping\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}\isabv{p}{\isachardot}\ port{\isachardot}side\ \isabv{p}\ {\isacharequal}\ Out{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\ \isabv{x}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ {\isacharparenleft}\ Mapping{\isachardot}map{\isacharunderscore}values\ {\isacharparenleft}{\isasymlambda}\isabv{k}{\isachardot}\ map\ edge{\isacharunderscore}from{\isacharparenright}\ {\isacharparenleft}edgesByOpenTo\ {\isacharparenleft}pg{\isacharunderscore}edges\ \isabv{x}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ {\isacharparenleft}\ Mapping{\isachardot}map{\isacharunderscore}values\ {\isacharparenleft}{\isasymlambda}\isabv{k}{\isachardot}\ map\ edge{\isacharunderscore}to{\isacharparenright}\ {\isacharparenleft}edgesByOpenFrom\ {\isacharparenleft}pg{\isacharunderscore}edges\ \isabv{y}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}%
