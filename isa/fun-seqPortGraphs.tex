\isacomm{fun}\ seqPortGraphs\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}\isatv{s}\ {\isacharcolon}{\isacharcolon}\ side{\isacharunderscore}in{\isacharunderscore}out{\isacharcomma}\ \isatv{a}{\isacharcomma}\ \isatv{p}{\isacharcomma}\ \isatv{l}{\isacharparenright}\ port{\isacharunderscore}graph\ {\isasymRightarrow}\ {\isacharparenleft}\isatv{s}{\isacharcomma}\ \isatv{a}{\isacharcomma}\ \isatv{p}{\isacharcomma}\ \isatv{l}{\isacharparenright}\ port{\isacharunderscore}graph\isanewline
\isaindent{\isacomm{fun}\ seqPortGraphs\ }{\isasymRightarrow}\ {\isacharparenleft}\isatv{s}{\isacharcomma}\ \isatv{a}{\isacharcomma}\ \isatv{p}{\isacharcomma}\ \isatv{l}{\isacharparenright}\ port{\isacharunderscore}graph{\isachardoublequoteclose}\isanewline
\ \ \isaOcomm{where}\ {\isachardoublequoteopen}\isafv{seqPortGraphs}\ \isabv{x\ y}\ {\isacharequal}\ PGraph\isanewline
\ \ \ \ {\isacharparenleft}\ pg{\isacharunderscore}nodes\ \isabv{x}\ {\isacharat}\ pg{\isacharunderscore}nodes\ \isabv{y}{\isacharparenright}\isanewline
\ \ \ \ {\isacharparenleft}\ seqInterfaceEdges\ \isabv{x\ y}\ {\isacharat}\isanewline
\ \ \ \ \ \ disconnectFromPlaces\isanewline
\isaindent{\ \ \ \ \ \ di}{\isacharparenleft}map\ OpenPort\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}\isabv{x}{\isachardot}\ port{\isachardot}side\ \isabv{x}\ {\isacharequal}\ Out{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\ \isabv{x}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\isaindent{\ \ \ \ \ \ di}{\isacharparenleft}pg{\isacharunderscore}edges\ \isabv{x}{\isacharparenright}\ {\isacharat}\isanewline
\ \ \ \ \ \ map\ {\isacharparenleft}shiftOpenInEdge\isanewline
\isaindent{\ \ \ \ \ \ map\ {\isacharparenleft}sh}{\isacharparenleft}{\isasymlambda}\isabv{s}{\isachardot}\ \isanotation{if}\ \isabv{s}\ {\isacharequal}\ In\ {\isasymor}\ \isabv{s}\ {\isacharequal}\ Out\ \isanotation{then}\ {\isadigit{0}}\isanewline
\isaindent{\ \ \ \ \ \ map\ {\isacharparenleft}sh{\isacharparenleft}{\isasymlambda}\isabv{s}{\isachardot}\ }\isanotation{else}\ length\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}\isabv{x}{\isachardot}\ port{\isachardot}side\ \isabv{x}\ {\isacharequal}\ \isabv{s}{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\ \isabv{x}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\isaindent{\ \ \ \ \ \ map\ {\isacharparenleft}sh}{\isacharparenleft}{\isasymlambda}\isabv{s}{\isachardot}\ \isanotation{if}\ \isabv{s}\ {\isacharequal}\ In\ {\isasymor}\ \isabv{s}\ {\isacharequal}\ Out\ \isanotation{then}\ {\isadigit{0}}\isanewline
\isaindent{\ \ \ \ \ \ map\ {\isacharparenleft}sh{\isacharparenleft}{\isasymlambda}\isabv{s}{\isachardot}\ }\isanotation{else}\ length\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}\isabv{x}{\isachardot}\ port{\isachardot}side\ \isabv{x}\ {\isacharequal}\ \isabv{s}{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\ \isabv{x}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\isaindent{\ \ \ \ \ \ map\ }{\isacharparenleft}disconnectFromPlaces\isanewline
\isaindent{\ \ \ \ \ \ map\ {\isacharparenleft}di}{\isacharparenleft}map\ OpenPort\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}\isabv{x}{\isachardot}\ port{\isachardot}side\ \isabv{x}\ {\isacharequal}\ In{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\ \isabv{y}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\isaindent{\ \ \ \ \ \ map\ {\isacharparenleft}di}{\isacharparenleft}pg{\isacharunderscore}edges\ \isabv{y}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ {\isacharparenleft}\ filter\ {\isacharparenleft}{\isasymlambda}\isabv{x}{\isachardot}\ port{\isachardot}side\ \isabv{x}\ {\isasymnoteq}\ Out{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\ \isabv{x}{\isacharparenright}\ {\isacharat}\isanewline
\ \ \ \ \ \ filter\ {\isacharparenleft}{\isasymlambda}\isabv{x}{\isachardot}\ port{\isachardot}side\ \isabv{x}\ {\isacharequal}\ Out{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\ \isabv{y}{\isacharparenright}\ {\isacharat}\isanewline
\ \ \ \ \ \ map\ {\isacharparenleft}shiftPort\ {\isacharparenleft}{\isasymlambda}\isabv{s}{\isachardot}\ length\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}\isabv{p}{\isachardot}\ port{\isachardot}side\ \isabv{p}\ {\isacharequal}\ \isabv{s}{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\ \isabv{x}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isaindent{map}\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}\isabv{x}{\isachardot}\ port{\isachardot}side\ \isabv{x}\ {\isasymnoteq}\ In\ {\isasymand}\ port{\isachardot}side\ \isabv{x}\ {\isasymnoteq}\ Out{\isacharparenright}\ {\isacharparenleft}pg{\isacharunderscore}ports\ \isabv{y}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}%
