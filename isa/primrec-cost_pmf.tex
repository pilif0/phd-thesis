\isacomm{primrec}\ cost{\isacharunderscore}pmf\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}\isatv{a}{\isacharcomma}\ \isatv{b}{\isacharcomma}\ \isatv{l}{\isacharcomma}\ rat{\isacharparenright}\ process\ {\isasymRightarrow}\ rat\ pmf{\isachardoublequoteclose}\isanewline
\ \ \isaOcomm{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Primitive\ \isabv{ins\ outs\ l\ m}{\isacharparenright}\ {\isacharequal}\ return{\isacharunderscore}pmf\ \isabv{m}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Identity\ \isabv{a}{\isacharparenright}\ {\isacharequal}\ return{\isacharunderscore}pmf\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Swap\ \isabv{a\ b}{\isacharparenright}\ {\isacharequal}\ return{\isacharunderscore}pmf\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Seq\ \isabv{p\ q}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \isafv{cost{\isacharunderscore}pmf}\ \isabv{p}\ {\isasymbind}\ {\isacharparenleft}{\isasymlambda}\isabv{x}{\isachardot}\ \isafv{cost{\isacharunderscore}pmf}\ \isabv{q}\ {\isasymbind}\ {\isacharparenleft}{\isasymlambda}\isabv{y}{\isachardot}\ return{\isacharunderscore}pmf\ {\isacharparenleft}\isabv{x}\ {\isacharplus}\ \isabv{y}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Par\ \isabv{p\ q}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \isafv{cost{\isacharunderscore}pmf}\ \isabv{p}\ {\isasymbind}\ {\isacharparenleft}{\isasymlambda}\isabv{x}{\isachardot}\ \isafv{cost{\isacharunderscore}pmf}\ \isabv{q}\ {\isasymbind}\ {\isacharparenleft}{\isasymlambda}\isabv{y}{\isachardot}\ return{\isacharunderscore}pmf\ {\isacharparenleft}\isabv{x}\ {\isacharplus}\ \isabv{y}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Opt\ \isabv{dopt\ p\ q}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}\ \isanotation{case}\ \isabv{dopt}\ \isanotation{of}\isanewline
\ \ \ \ \ \ \ \ Some\ \isabv{d}\ {\isasymRightarrow}\ \isabv{d}\ {\isasymbind}\ case{\isacharunderscore}bchoice\ {\isacharparenleft}\isafv{cost{\isacharunderscore}pmf}\ \isabv{p}{\isacharparenright}\ {\isacharparenleft}\isafv{cost{\isacharunderscore}pmf}\ \isabv{q}{\isacharparenright}\isanewline
\ \ \ \ \ \ {\isacharbar}\ None\ {\isasymRightarrow}\ \isafv{cost{\isacharunderscore}pmf}\ \isabv{p}\ {\isasymbind}\ {\isacharparenleft}{\isasymlambda}\isabv{x}{\isachardot}\ \isafv{cost{\isacharunderscore}pmf}\ \isabv{q}\ {\isasymbind}\ {\isacharparenleft}{\isasymlambda}\isabv{y}{\isachardot}\ return{\isacharunderscore}pmf\ {\isacharparenleft}\isabv{x}\ {\isacharplus}\ \isabv{y}\ {\isacharslash}\ {\isadigit{2}}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}OptDistrIn\ \isabv{d\ a\ b\ c}{\isacharparenright}\ {\isacharequal}\ return{\isacharunderscore}pmf\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}OptDistrOut\ \isabv{d\ a\ b\ c}{\isacharparenright}\ {\isacharequal}\ return{\isacharunderscore}pmf\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Duplicate\ \isabv{a}{\isacharparenright}\ {\isacharequal}\ return{\isacharunderscore}pmf\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Erase\ \isabv{a}{\isacharparenright}\ {\isacharequal}\ return{\isacharunderscore}pmf\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Repeat\ \isabv{a\ b}{\isacharparenright}\ {\isacharequal}\ return{\isacharunderscore}pmf\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Close\ \isabv{a\ b}{\isacharparenright}\ {\isacharequal}\ return{\isacharunderscore}pmf\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Once\ \isabv{a\ b}{\isacharparenright}\ {\isacharequal}\ return{\isacharunderscore}pmf\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}\ {\isachardoublequoteopen}\isafv{cost{\isacharunderscore}pmf}\ {\isacharparenleft}Forget\ \isabv{a}{\isacharparenright}\ {\isacharequal}\ return{\isacharunderscore}pmf\ {\isadigit{0}}{\isachardoublequoteclose}
