\isacomm{fun}\ nodePortGraph\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}\isatv{p}\ list\ {\isasymRightarrow}\ \isatv{l}\ {\isasymRightarrow}\ \isatv{a}\ list\ {\isasymRightarrow}\ \isatv{a}\ list\isanewline
\isaindent{\isacomm{fun}\ nodePortGraph\ }{\isasymRightarrow}\ {\isacharparenleft}\isatv{s}\ {\isacharcolon}{\isacharcolon}\ side{\isacharunderscore}in{\isacharunderscore}out{\isacharcomma}\ \isatv{a}{\isacharcomma}\ \isatv{p}{\isacharcomma}\ \isatv{l}{\isacharparenright}\ port{\isacharunderscore}graph{\isachardoublequoteclose}\isanewline
\ \ \isaOcomm{where}\ {\isachardoublequoteopen}\isafv{nodePortGraph}\ \isabv{n\ l\ ins\ outs}\ {\isacharequal}\ PGraph\isanewline
\ \ \ \ {\isacharbrackleft}Node\ \isabv{n\ l}\ {\isacharparenleft}listPorts\ {\isadigit{0}}\ In\ \isabv{ins}\ {\isacharat}\ listPorts\ {\isadigit{0}}\ Out\ \isabv{outs}{\isacharparenright}{\isacharbrackright}\isanewline
\ \ \ \ {\isacharparenleft}map{\isadigit{2}}\ Edge\ {\isacharparenleft}map\ OpenPort\ {\isacharparenleft}listPorts\ {\isadigit{0}}\ In\ \isabv{ins}{\isacharparenright}{\isacharparenright}\isanewline
\isaindent{\ \ \ \ {\isacharparenleft}map{\isadigit{2}}\ Edge\ }{\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}\isabv{p}{\isachardot}\ GroundPort\ {\isacharparenleft}QPort\ \isabv{p\ n}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}listPorts\ {\isadigit{0}}\ In\ \isabv{ins}{\isacharparenright}{\isacharparenright}\ {\isacharat}\isanewline
\ \ \ \ \ map{\isadigit{2}}\ Edge\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}\isabv{p}{\isachardot}\ GroundPort\ {\isacharparenleft}QPort\ \isabv{p\ n}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}listPorts\ {\isadigit{0}}\ Out\ outs{\isacharparenright}{\isacharparenright}\isanewline
\isaindent{\ \ \ \ \ map{\isadigit{2}}\ Edge\ }{\isacharparenleft}map\ OpenPort\ {\isacharparenleft}listPorts\ {\isadigit{0}}\ Out\ \isabv{outs}{\isacharparenright}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ {\isacharparenleft}listPorts\ {\isadigit{0}}\ In\ \isabv{ins}\ {\isacharat}\ listPorts\ {\isadigit{0}}\ Out\ \isabv{outs}{\isacharparenright}{\isachardoublequoteclose}
